<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>入门 | 略记一二</title>
    <meta name="generator" content="VuePress 1.5.4">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="笔记记了是要常常翻出来看的，不然干嘛要花那么多时间记笔记？">
    <link rel="preload" href="/assets/css/0.styles.e11ec23d.css" as="style"><link rel="preload" href="/assets/js/app.e38833ea.js" as="script"><link rel="preload" href="/assets/js/2.17cbeac6.js" as="script"><link rel="preload" href="/assets/js/81.3c52e5ef.js" as="script"><link rel="prefetch" href="/assets/js/10.250fcf81.js"><link rel="prefetch" href="/assets/js/11.f157cd0b.js"><link rel="prefetch" href="/assets/js/12.a9bf3862.js"><link rel="prefetch" href="/assets/js/13.896ca89d.js"><link rel="prefetch" href="/assets/js/14.87494d07.js"><link rel="prefetch" href="/assets/js/15.f68977cd.js"><link rel="prefetch" href="/assets/js/16.b94738a9.js"><link rel="prefetch" href="/assets/js/17.e2c75320.js"><link rel="prefetch" href="/assets/js/18.771a5ec2.js"><link rel="prefetch" href="/assets/js/19.d49b8edf.js"><link rel="prefetch" href="/assets/js/20.555d276b.js"><link rel="prefetch" href="/assets/js/21.e44090be.js"><link rel="prefetch" href="/assets/js/22.097d6f98.js"><link rel="prefetch" href="/assets/js/23.4b3259b7.js"><link rel="prefetch" href="/assets/js/24.3c89c6ed.js"><link rel="prefetch" href="/assets/js/25.f67fd8aa.js"><link rel="prefetch" href="/assets/js/26.884593de.js"><link rel="prefetch" href="/assets/js/27.0564c2cb.js"><link rel="prefetch" href="/assets/js/28.e1a2c4d8.js"><link rel="prefetch" href="/assets/js/29.1ebfe2ec.js"><link rel="prefetch" href="/assets/js/3.dac61e26.js"><link rel="prefetch" href="/assets/js/30.8c4ee977.js"><link rel="prefetch" href="/assets/js/31.8986c831.js"><link rel="prefetch" href="/assets/js/32.4b30f57a.js"><link rel="prefetch" href="/assets/js/33.b9a4cf5e.js"><link rel="prefetch" href="/assets/js/34.776e490e.js"><link rel="prefetch" href="/assets/js/35.9bdcf90b.js"><link rel="prefetch" href="/assets/js/36.b5932fba.js"><link rel="prefetch" href="/assets/js/37.df17cf67.js"><link rel="prefetch" href="/assets/js/38.3d8b4eda.js"><link rel="prefetch" href="/assets/js/39.b3be75c3.js"><link rel="prefetch" href="/assets/js/4.b0dc7c39.js"><link rel="prefetch" href="/assets/js/40.96fd608f.js"><link rel="prefetch" href="/assets/js/41.0513a23b.js"><link rel="prefetch" href="/assets/js/42.6cd3cc53.js"><link rel="prefetch" href="/assets/js/43.5ef51692.js"><link rel="prefetch" href="/assets/js/44.794100ff.js"><link rel="prefetch" href="/assets/js/45.d10168fa.js"><link rel="prefetch" href="/assets/js/46.10688120.js"><link rel="prefetch" href="/assets/js/47.094c2cd3.js"><link rel="prefetch" href="/assets/js/48.95a26822.js"><link rel="prefetch" href="/assets/js/49.41c75b8f.js"><link rel="prefetch" href="/assets/js/5.c61e0a12.js"><link rel="prefetch" href="/assets/js/50.06594e41.js"><link rel="prefetch" href="/assets/js/51.4227a338.js"><link rel="prefetch" href="/assets/js/52.b756be3f.js"><link rel="prefetch" href="/assets/js/53.0d45f222.js"><link rel="prefetch" href="/assets/js/54.a37e137d.js"><link rel="prefetch" href="/assets/js/55.81a19fae.js"><link rel="prefetch" href="/assets/js/56.800ff698.js"><link rel="prefetch" href="/assets/js/57.70844d0c.js"><link rel="prefetch" href="/assets/js/58.f750a736.js"><link rel="prefetch" href="/assets/js/59.46a720cc.js"><link rel="prefetch" href="/assets/js/6.b167fa87.js"><link rel="prefetch" href="/assets/js/60.281e7077.js"><link rel="prefetch" href="/assets/js/61.03db5b64.js"><link rel="prefetch" href="/assets/js/62.3ef279a6.js"><link rel="prefetch" href="/assets/js/63.58d1689f.js"><link rel="prefetch" href="/assets/js/64.691b77a9.js"><link rel="prefetch" href="/assets/js/65.aea71ebe.js"><link rel="prefetch" href="/assets/js/66.fdcb5c4c.js"><link rel="prefetch" href="/assets/js/67.3851f01d.js"><link rel="prefetch" href="/assets/js/68.eff1c7f3.js"><link rel="prefetch" href="/assets/js/69.b97074c2.js"><link rel="prefetch" href="/assets/js/7.092eb31d.js"><link rel="prefetch" href="/assets/js/70.7525968a.js"><link rel="prefetch" href="/assets/js/71.fdc9d9ba.js"><link rel="prefetch" href="/assets/js/72.e699fc43.js"><link rel="prefetch" href="/assets/js/73.a075b568.js"><link rel="prefetch" href="/assets/js/74.ad5edd6a.js"><link rel="prefetch" href="/assets/js/75.fcf08968.js"><link rel="prefetch" href="/assets/js/76.0fcbd3a7.js"><link rel="prefetch" href="/assets/js/77.1b7c112c.js"><link rel="prefetch" href="/assets/js/78.0aa2e0c8.js"><link rel="prefetch" href="/assets/js/79.036605dc.js"><link rel="prefetch" href="/assets/js/8.6636c5ea.js"><link rel="prefetch" href="/assets/js/80.2c62bfcb.js"><link rel="prefetch" href="/assets/js/82.541ed7c1.js"><link rel="prefetch" href="/assets/js/83.db9e79cf.js"><link rel="prefetch" href="/assets/js/9.71cb8be9.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e11ec23d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">略记一二</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="http://blog.dangosky.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/DangoSky" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="http://blog.dangosky.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/DangoSky" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>TypeScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React-Route</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Node</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据库</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Mobx</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Git</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Webpack</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Webpack/入门.html" class="active sidebar-link">入门</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Webpack/入门.html#webpack-安装" class="sidebar-link">webpack 安装</a></li><li class="sidebar-sub-header"><a href="/Webpack/入门.html#webpack-基本配置" class="sidebar-link">webpack 基本配置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Webpack/入门.html#打包后的文件名带哈希值" class="sidebar-link">打包后的文件名带哈希值</a></li></ul></li><li class="sidebar-sub-header"><a href="/Webpack/入门.html#插件" class="sidebar-link">插件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Webpack/入门.html#自动引入打包后的文件" class="sidebar-link">自动引入打包后的文件</a></li><li class="sidebar-sub-header"><a href="/Webpack/入门.html#清除上次遗留的打包文件" class="sidebar-link">清除上次遗留的打包文件</a></li><li class="sidebar-sub-header"><a href="/Webpack/入门.html#解析-css" class="sidebar-link">解析 CSS</a></li><li class="sidebar-sub-header"><a href="/Webpack/入门.html#将-css-单独打包到一个文件中" class="sidebar-link">将 CSS 单独打包到一个文件中</a></li><li class="sidebar-sub-header"><a href="/Webpack/入门.html#css-自动添加浏览器前缀" class="sidebar-link">CSS 自动添加浏览器前缀</a></li><li class="sidebar-sub-header"><a href="/Webpack/入门.html#打包图片" class="sidebar-link">打包图片</a></li><li class="sidebar-sub-header"><a href="/Webpack/入门.html#使用-babel-转义-js" class="sidebar-link">使用 babel 转义 JS</a></li></ul></li><li class="sidebar-sub-header"><a href="/Webpack/入门.html#如何提高打包速度" class="sidebar-link">如何提高打包速度</a></li><li class="sidebar-sub-header"><a href="/Webpack/入门.html#收录一些依赖包" class="sidebar-link">收录一些依赖包</a></li><li class="sidebar-sub-header"><a href="/Webpack/入门.html#todo" class="sidebar-link">TODO：</a></li></ul></li><li><a href="/Webpack/F&amp;Q.html" class="sidebar-link">F&amp;Q</a></li><li><a href="/Webpack/Babel.html" class="sidebar-link">Babel</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Linux</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>计算机网络</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>操作系统</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="入门"><a href="#入门" class="header-anchor">#</a> 入门</h1> <h2 id="webpack-安装"><a href="#webpack-安装" class="header-anchor">#</a> webpack 安装</h2> <ul><li><code>npm i -D webpack webpack-cli</code>。</li></ul> <blockquote><p>其中 <code>-D</code> 是 <code>--save-dev</code> 的缩写，<code>-S</code> 是 <code>--save</code> 的缩写。
<code>-D</code> 会把依赖包安装到 <code>package.json</code> 中的 <code>devDependencies</code>， <code>-S</code> 则把依赖包安装到 <code>dependencies</code> 中。 <code>devDependencies</code> 中的包是开发环境时的依赖包，到了正式生产环境则不需要用到了。<code>dependencies</code> 中的包则在生产环境中依旧要用到。</p></blockquote> <h2 id="webpack-基本配置"><a href="#webpack-基本配置" class="header-anchor">#</a> webpack 基本配置</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// webpack.config.js</span>

<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token operator">:</span> <span class="token string">'development'</span><span class="token punctuation">,</span> <span class="token comment">// 开发模式，默认为 production</span>
  entry<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../src/main.js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token comment">// 入口文件。也可以是一个对象支持多个入口文件，键名为模块名</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 出口配置</span>
    filename<span class="token operator">:</span> <span class="token string">'output.js'</span><span class="token punctuation">,</span>      <span class="token comment">// 打包后的文件名称</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../dist'</span><span class="token punctuation">)</span>  <span class="token comment">// 打包后的目录</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="打包后的文件名带哈希值"><a href="#打包后的文件名带哈希值" class="header-anchor">#</a> 打包后的文件名带哈希值</h3> <div class="language-js extra-class"><pre class="language-js"><code>output<span class="token operator">:</span> <span class="token punctuation">{</span>
  filename<span class="token operator">:</span> <span class="token string">'[name].[hash:8].js'</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>原因：在打包出来的文件名上加上文件内容的 hash，主要是为了有效使用浏览器长缓存。JS 文件如果有内容更新，hash 就会更新，浏览器请求路径变化所以更新缓存；如果 JS 内容不变，hash 也不会改变，则直接用缓存。</li></ul> <h2 id="插件"><a href="#插件" class="header-anchor">#</a> 插件</h2> <h3 id="自动引入打包后的文件"><a href="#自动引入打包后的文件" class="header-anchor">#</a> 自动引入打包后的文件</h3> <ul><li><p>安装：<code>npm i -D html-webpack-plugin</code>。</p></li> <li><p>webpack.config.js 配置：</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span>

plugins<span class="token operator">:</span><span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    template<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../public/index.html'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre></div><ul><li><p>作用：打包 template 中指定的 HTML 文件，并在打包后的 HTML 文件中自动引入打包后的 JS 文件。这样就可以不用每次打包 JS 文件后，由于 JS 文件名的哈希值发生变化了而修改 HTML 文件中 JS 的引入名了。</p></li> <li><p>如果有多个入口文件，则可以使用多个 HtmlWebpackPlugin 实例，分别对应不同的入口文件。</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token operator">:</span><span class="token string">'development'</span><span class="token punctuation">,</span>
  entry<span class="token operator">:</span> <span class="token punctuation">{</span>
    main<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../src/main.js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    header<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../src/header.js'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> 
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'[name].[hash:8].js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../dist'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      template<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../public/index.html'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      filename<span class="token operator">:</span> <span class="token string">'index.html'</span><span class="token punctuation">,</span>
      chunks<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'main'</span><span class="token punctuation">]</span>  <span class="token comment">// 与入口文件对应的模块名</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      template<span class="token operator">:</span>  path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../public/header.html'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      filename<span class="token operator">:</span> <span class="token string">'header.html'</span><span class="token punctuation">,</span>
      chunks<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'header'</span><span class="token punctuation">]</span> 
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="清除上次遗留的打包文件"><a href="#清除上次遗留的打包文件" class="header-anchor">#</a> 清除上次遗留的打包文件</h3> <ul><li><p>安装：<code>npm install -D clean-webpack-plugin</code>。</p></li> <li><p>webpack.config.js 配置：</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code>plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre></div><h3 id="解析-css"><a href="#解析-css" class="header-anchor">#</a> 解析 CSS</h3> <ul><li><p>安装：</p> <ul><li>解析 CSS：<code>npm i -D style-loader css-loader</code>。</li> <li>解析 Less：<code>npm i -D less less-loader</code>。</li></ul></li> <li><p>webpack.config.js 配置：</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token operator">:</span> <span class="token punctuation">{</span>
  rules<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      test<span class="token operator">:</span> <span class="token regex">/\.css$/</span><span class="token punctuation">,</span>
      use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'style-loader'</span><span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">]</span> 
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      test<span class="token operator">:</span> <span class="token regex">/\.less$/</span><span class="token punctuation">,</span>
      use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'style-loader'</span><span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span> <span class="token string">'less-loader'</span><span class="token punctuation">]</span> 
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>说明：loader 的解析是从右向左的。执行时先用 css-loader 将 CSS 文件转成对象，传递给 style-loader 插入到 head 的 style 中。如果是用 Less 的话，则需要先将 Less 转换成 Css。</li></ul> <h3 id="将-css-单独打包到一个文件中"><a href="#将-css-单独打包到一个文件中" class="header-anchor">#</a> 将 CSS 单独打包到一个文件中</h3> <h4 id="使用-mini-css-extract-plugin-插件-推荐"><a href="#使用-mini-css-extract-plugin-插件-推荐" class="header-anchor">#</a> 使用 <code>mini-css-extract-plugin</code> 插件（推荐）</h4> <blockquote><p><a href="https://webpack.js.org/plugins/mini-css-extract-plugin/" target="_blank" rel="noopener noreferrer">参考文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <ul><li><p>安装：<code>npm i -D mini-css-extract-plugin</code>。</p></li> <li><p>webpack.config.js 配置：</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;mini-css-extract-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      filename<span class="token operator">:</span> <span class="token string">&quot;[name].[hash].css&quot;</span><span class="token punctuation">,</span>
      chunkFilename<span class="token operator">:</span> <span class="token string">&quot;[id].css&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex">/\.(c|le)ss$/</span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>
          MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span>
          <span class="token string">'css-loader'</span><span class="token punctuation">,</span>
          <span class="token string">'less-loader'</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>说明：使用 loader 打包 CSS 时，默认是将 CSS 打包到对应的 JS 文件里面去的，所以页面加载的时候会先解析完了 JS 之后再去加载 CSS，会影响用户体验。使用 <code>mini-css-extract-plugin</code> 或 <code>extract-text-webpack-plugin</code> 插件可以把入口文件里引用到的 CSS 文件单独打包成一个文件，并自动引入到打包后的 HTML 文件中。</li></ul> <h4 id="使用-extract-text-webpack-plugin-插件"><a href="#使用-extract-text-webpack-plugin-插件" class="header-anchor">#</a> 使用 <code>extract-text-webpack-plugin</code> 插件</h4> <blockquote><p><a href="https://webpack.docschina.org/plugins/extract-text-webpack-plugin/" target="_blank" rel="noopener noreferrer">参考文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <ul><li><p>安装：<code>npm i extract-text-webpack-plugin@next</code>。</p></li> <li><p>webpack.config.js 配置：</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> ExtractTextPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;extract-text-webpack-plugin&quot;</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">ExtractTextPlugin</span><span class="token punctuation">(</span><span class="token string">&quot;css/[name].css&quot;</span><span class="token punctuation">)</span> <span class="token comment">// 指定打包后的 CSS 文件位置，相对于出口路径而言，并可以指定文件名</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex">/\.css|.less$/</span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> ExtractTextPlugin<span class="token punctuation">.</span><span class="token function">extract</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          fallback<span class="token operator">:</span> <span class="token string">'style-loader'</span><span class="token punctuation">,</span>
          use<span class="token operator">:</span> <span class="token string">'css-loader'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>      
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>说明：<code>extract-text-webpack-plugin</code> 插件可以将引入的多个 CSS 文件一一打包成多个对应的 CSS 文件。<code>mini-css-extract-plugin</code> 插件只能打包成一个 CSS 文件。</li></ul> <h3 id="css-自动添加浏览器前缀"><a href="#css-自动添加浏览器前缀" class="header-anchor">#</a> CSS 自动添加浏览器前缀</h3> <ul><li><p>安装：<code>npm i -D postcss-loader autoprefixer</code>。</p></li> <li><p>webpack.config.js 配置：</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  rules<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    test<span class="token operator">:</span> <span class="token regex">/\.css|.less$/</span><span class="token punctuation">,</span>
    use<span class="token operator">:</span> ExtractTextPlugin<span class="token punctuation">.</span><span class="token function">extract</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      fallback<span class="token operator">:</span> <span class="token string">'style-loader'</span><span class="token punctuation">,</span>
      use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'css-loader'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> 
        loader<span class="token operator">:</span> <span class="token string">'postcss-loader'</span><span class="token punctuation">,</span> 
          options<span class="token operator">:</span> <span class="token punctuation">{</span>
            plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
              <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'autoprefixer'</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
                <span class="token comment">// 要适配的浏览器</span>
                overrideBrowserslist<span class="token operator">:</span> <span class="token punctuation">[</span>
                  <span class="token string">&quot;defaults&quot;</span><span class="token punctuation">,</span>
                  <span class="token string">&quot;not ie &lt; 11&quot;</span><span class="token punctuation">,</span>
                  <span class="token string">&quot;last 2 versions&quot;</span><span class="token punctuation">,</span>
                  <span class="token string">&quot;&gt; 1%&quot;</span><span class="token punctuation">,</span>
                  <span class="token string">&quot;iOS 7&quot;</span><span class="token punctuation">,</span>
                  <span class="token string">&quot;last 3 iOS versions&quot;</span>
                <span class="token punctuation">]</span>
              <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">]</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">'less-loader'</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>      
  <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="打包图片"><a href="#打包图片" class="header-anchor">#</a> 打包图片</h3> <ul><li><p>安装：<code>npm i -D file-loader url-loader</code>。</p></li> <li><p>webpack.config.js 配置：</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token operator">:</span> <span class="token punctuation">{</span>
  rules<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    test<span class="token operator">:</span> <span class="token regex">/\.(jpeg|jpg|png|gif)$/</span><span class="token punctuation">,</span>
    loader<span class="token operator">:</span> <span class="token string">'file-loader'</span><span class="token punctuation">,</span>
    <span class="token comment">// 打包路径需要注意好，否则打包后的图片路径和其引用路径会对不上</span>
    options<span class="token operator">:</span> <span class="token punctuation">{</span>
      name<span class="token operator">:</span> <span class="token string">'[name].[hash:8].[ext]'</span><span class="token punctuation">,</span>
      publicPath<span class="token operator">:</span> <span class="token string">'../images/'</span><span class="token punctuation">,</span>   <span class="token comment">// 图片打包的目录</span>
      outputPath<span class="token operator">:</span> <span class="token string">'images/'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="使用-url-loader-打包"><a href="#使用-url-loader-打包" class="header-anchor">#</a> 使用 url-loader 打包</h4> <ul><li>使用 url-loader 打包的话，则比 file-loader 多了一个 limit 选项（单位是 B）。当图片小于或等于 limit 值，则图片不会被打包而是直接转化成 base64 格式，从而减小网络请求；否则的话图片就正常打包。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token operator">:</span> <span class="token punctuation">{</span>
  rules<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    test<span class="token operator">:</span> <span class="token regex">/\.(jpeg|jpg|png|gif)$/</span><span class="token punctuation">,</span>
    loader<span class="token operator">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span>
    options<span class="token operator">:</span> <span class="token punctuation">{</span>
      limit<span class="token operator">:</span> <span class="token number">1024</span><span class="token punctuation">,</span>  <span class="token comment">// 图片</span>
      name<span class="token operator">:</span> <span class="token string">'[name].[hash:8].[ext]'</span><span class="token punctuation">,</span>
      publicPath<span class="token operator">:</span> <span class="token string">'../images/'</span><span class="token punctuation">,</span>
      outputPath<span class="token operator">:</span> <span class="token string">'images/'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="打包-html-文件中引用的图片"><a href="#打包-html-文件中引用的图片" class="header-anchor">#</a> 打包 HTML 文件中引用的图片</h4> <ul><li>如果图片是通过在 HTML 文件中通过 <code>&lt;img src=image.png&quot;&gt;</code> 引入的，那么此时还需要使用 <code>html-loader</code> 解析才能成功打包 HTML 中引用的图片，即将图片的引入转换为 <code>require(&quot;./image.png&quot;)</code>。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token operator">:</span> <span class="token punctuation">{</span>
  rules<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      test<span class="token operator">:</span> <span class="token regex">/\.(jpeg|jpg|png|gif)$/</span><span class="token punctuation">,</span>
      loader<span class="token operator">:</span> <span class="token string">'file-loader'</span><span class="token punctuation">,</span>
      options<span class="token operator">:</span> <span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token string">'images/[name].[hash:8].[ext]'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      test<span class="token operator">:</span> <span class="token regex">/\.html$/</span><span class="token punctuation">,</span>
      use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
        loader<span class="token operator">:</span> <span class="token string">'html-loader'</span><span class="token punctuation">,</span>
        options<span class="token operator">:</span> <span class="token punctuation">{</span>
          minimize<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// 是否压缩打包后的 HTML 文件，true 的话则 HTML 文件会丢失空格和换行等格式</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>需要注意的是，因为打包后的 HTML 文件和 CSS 文件相对于打包后的 dist 文件目录可能不同（HTML 文件是 ./images，而 CSS 文件是 ../images），所以图片的引入路径可能会有问题，此时需要保证 HTML 和 CSS 文件相对于打包后的图片目录的路径是一致的。</li></ul> <h3 id="使用-babel-转义-js"><a href="#使用-babel-转义-js" class="header-anchor">#</a> 使用 babel 转义 JS</h3> <ul><li>安装： <code>npm i -D babel-loader @babel/preset-env @babel/core</code>。</li></ul> <blockquote><p>注意 <code>babel-loader</code> 与 <code>babel-core</code> 的版本对应关系</p> <p><code>babel-loader</code> 8.x 对应 <code>babel-core</code> 7.x</p> <p><code>babel-loader</code> 7.x 对应 <code>babel-core</code> 6.x</p></blockquote> <ul><li>webpack.config.js 配置：</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token operator">:</span> <span class="token punctuation">{</span>
  rules<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    test<span class="token operator">:</span> <span class="token regex">/\.js$/</span><span class="token punctuation">,</span>
    use<span class="token operator">:</span> <span class="token punctuation">{</span>
      loader<span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
      options<span class="token operator">:</span> <span class="token punctuation">{</span>
        presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@babel/preset-env'</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    exclude<span class="token operator">:</span> <span class="token regex">/node_modules/</span> <span class="token comment">// 不需要去转义 node_modules 文件中的文件，提高转义速度</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><code>babel-loader</code> 只会将 ES6/7/8 语法转换为 ES5 语法，但是对新 api 并不会转换（例如 Promise、Generator、Set、Maps、Proxy 等），所以还需要借助 <code>babel-polyfill</code> 来将这些语法 polyfill 掉。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@babel/polyfill&quot;</span><span class="token punctuation">,</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../src/main.js'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="如何提高打包速度"><a href="#如何提高打包速度" class="header-anchor">#</a> 如何提高打包速度</h2> <h4 id="合理区分环境。"><a href="#合理区分环境。" class="header-anchor">#</a> 合理区分环境。</h4> <ul><li>配置 mode 参数，默认值为生产模式，production 模式下会自动去除无用代码代码压缩混淆。</li></ul> <h4 id="缩小文件的搜索范围。"><a href="#缩小文件的搜索范围。" class="header-anchor">#</a> 缩小文件的搜索范围。</h4> <ul><li><p>alias: 别名配置。当代码中出现 <code>import {} from ''</code> 时， webpack 会采用向上递归搜索的方式去 <code>node_modules</code> 目录下找。为了减少搜索范围我们可以直接告诉webpack 去哪个路径下查找。</p></li> <li><p>include 和 exclude： 明确告诉 loader 需要作用或不作用的范围，比如常见的 <code>node_modules</code> 文件夹是不需要作用到的。</p></li> <li><p>noParse：当我们代码中使用到 <code>import jq from 'jquery'</code> 时，webpack 会去解析 <code>jq</code> 这个库是否有依赖其他的包，但是 <code>jquery</code> 这类库一般不会引用其他的包。使用 noParse 属性，告诉 webpack 不必解析它的依赖包以此增加打包速度。noParse 是可选的配置项，类型需要是 RegExp 、[RegExp] 或 function，配置如下：</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 使用正则表达式 </span>
noParse<span class="token operator">:</span> <span class="token regex">/jquerylchartjs/</span> 

<span class="token comment">// 使用函数，从 Webpack3.0.0开始支持 </span>
<span class="token function-variable function">noParse</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">content</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span> 
  <span class="token keyword">return</span> <span class="token regex">/jquery|chartjs/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
</code></pre></div><ul><li>extensions：当导入的文件没有写后缀时，webpack 会自动带上后缀后去尝试询问文件是否存在，默认是：<code>extensions: [&quot;.js&quot;, &quot;.json&quot;]</code> 。所以频率较高的文件类型应该优先写在前面，避免匹配的次数过多。</li></ul> <h4 id="使用-happypack-开启多进程-loader-转换。"><a href="#使用-happypack-开启多进程-loader-转换。" class="header-anchor">#</a> 使用 HappyPack 开启多进程 Loader 转换。</h4> <ul><li>在 webpack 构建过程中，实际上耗费时间大多数用在 loader 解析转换以及代码的压缩中。因为 js 是单线程的不能并发处理文件如转换 JS、CSS 和图片等，<code>HappyPack</code> 可以将这部分任务分解到多个子进程中去并行处理，子进程处理完成后把结果发送到主进程中，从而减少总的构建时间。</li></ul> <h4 id="使用-webpack-parallel-uglify-plugin-增强代码压缩。"><a href="#使用-webpack-parallel-uglify-plugin-增强代码压缩。" class="header-anchor">#</a> 使用 webpack-parallel-uglify-plugin 增强代码压缩。</h4> <h4 id="抽离第三方模块。"><a href="#抽离第三方模块。" class="header-anchor">#</a> 抽离第三方模块。</h4> <ul><li>对于开发项目中不会经常变更的静态依赖文件比如 react、react-dom、mobx、antd 等，只要我们不升级这些库的话是不需要打包它们的。使用 webpack 内置的 <code>DllPlugin DllReferencePlugin</code> 将它们抽离出来，就可以在每次构建时不去编译这些第三方库，而只是打包项目中的代码文件，这样可以大大提高构建速度。需要的操作包括：</li></ul> <ol><li>新建一个 <code>webpack.dll.config.js</code> 配置文件。</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// webpack.dll.config.js</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;webpack&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token punctuation">{</span>
    vendor<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'vue'</span><span class="token punctuation">,</span><span class="token string">'element-ui'</span><span class="token punctuation">]</span>  <span class="token comment">// 要抽离的第三方库</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'static/js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>   <span class="token comment">// 打包后文件输出的位置</span>
    filename<span class="token operator">:</span> <span class="token string">'[name].dll.js'</span><span class="token punctuation">,</span>
    library<span class="token operator">:</span> <span class="token string">'[name]_library'</span> <span class="token comment">// 这里需要和 webpack.DllPlugin 中的 name 字段保持一致</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DllPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'[name]-manifest.json'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token string">'[name]_library'</span><span class="token punctuation">,</span> 
      context<span class="token operator">:</span> __dirname
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ol start="2"><li><p>在 <code>package.json</code> 中配置脚本运行命令：<code>&quot;dll&quot;: &quot;webpack --config build/webpack.dll.config.js&quot;</code>。</p></li> <li><p>在我们的 <code>webpack.config.js</code> 中增加以下代码，执行 <code>npm run dll</code> 打包，以后只有在更新这些第三方库的时候才需要再 <code>npm run dll</code> 了。</p></li></ol> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DllReferencePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      context<span class="token operator">:</span> __dirname<span class="token punctuation">,</span>
      manifest<span class="token operator">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./vendor-manifest.json'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">CopyWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token comment">// 拷贝生成的文件到 dist 目录 这样每次不必手动去cv</span>
      <span class="token punctuation">{</span>
        <span class="token keyword">from</span><span class="token operator">:</span> <span class="token string">'static'</span><span class="token punctuation">,</span>
        to<span class="token operator">:</span><span class="token string">'static'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ol start="4"><li>将生成的打包文件 <code>vendor.dll.js</code> 引入 HTML 文件中。</li></ol> <h4 id="配置缓存"><a href="#配置缓存" class="header-anchor">#</a> 配置缓存</h4> <ul><li><p>每次执行构建都会把所有的文件都重复编译一遍，使用缓存的话可以避免重复的编译。大部分 loader 都提供了 cache 配置项。比如在 babel-loader 中，可以通过设置 <code>cacheDirectory</code> 来开启缓存，<code>babel-loader?cacheDirectory=true</code> 就会将每次的编译结果写进硬盘文件（默认是在项目根目录下的<code>node_modules/.cache/babel-loader</code> 目录内，不过可以自定义）。</p></li> <li><p>如果 loader 不支持缓存的话，可以安装 cache-loader 来实现（<code>npm i -D cache-loader</code>），原理同上也是将 loader 编译的结果写入硬盘缓存。再次构建时会先比较一下，如果文件较之前的没有发生变化则会直接使用缓存</p></li></ul> <h4 id="优化打包文件体积"><a href="#优化打包文件体积" class="header-anchor">#</a> 优化打包文件体积</h4> <ul><li><p>引入 <code>webpack-bundle-analyzer</code> 生成 GUI 界面分析打包后的文件。</p></li> <li><p>开启 <code>Tree-shaking</code> 清除无用代码。</p></li></ul> <h2 id="收录一些依赖包"><a href="#收录一些依赖包" class="header-anchor">#</a> 收录一些依赖包</h2> <ul><li><p><code>@babel/parser</code>：将源代码解析成 AST。</p></li> <li><p><code>@babel/traverse</code>：对AST节点进行递归遍历，生成一个便于操作、转换的path对象。</p></li> <li><p><code>@babel/generator</code>：将AST解码生成js代码。</p></li> <li><p><code>@babel/types</code>：通过该模块对具体的AST节点进行进行增删改查。</p></li></ul> <blockquote><p>上面这几个依赖包可以用来实现对 JS 文件的修改，比如编写 loader 删掉 JS 中的 console 等。</p></blockquote> <blockquote><p><a href="https://webpack.docschina.org/contribute/writing-a-loader/" target="_blank" rel="noopener noreferrer">如何编写一个 loader<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://www.webpackjs.com/contribute/writing-a-plugin/" target="_blank" rel="noopener noreferrer">如何编写一个插件<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <h2 id="todo"><a href="#todo" class="header-anchor">#</a> TODO：</h2> <ul><li><p>文件名添加哈希原理 </p></li> <li><p>解析图片 https://juejin.im/post/5d4bdb976fb9a06add4e192b#heading-3</p></li> <li><p>blog 阅读</p> <ul><li>https://www.cnblogs.com/cangqinglang/p/8715254.html</li></ul></li> <li><p>图片打包时进行压缩</p></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Git/rebase和merge的区别.html" class="prev">
        rebase和merge的区别
      </a></span> <span class="next"><a href="/Webpack/F&amp;Q.html">
        F&amp;Q
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.e38833ea.js" defer></script><script src="/assets/js/2.17cbeac6.js" defer></script><script src="/assets/js/81.3c52e5ef.js" defer></script>
  </body>
</html>
